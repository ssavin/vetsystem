# Backup —Å INSERT –∫–æ–º–∞–Ω–¥–∞–º–∏ - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### ‚úÖ Custom Format Backup (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
**backup_custom_20251019_142216.dump** (30 –ú–ë)
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç PostgreSQL
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `pg_restore`
- –ù–∞–¥–µ–∂–Ω–µ–µ —á–µ–º INSERT

### üìú –°–∫—Ä–∏–ø—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
**convert_to_inserts.sh**
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç COPY —Ñ–æ—Ä–º–∞—Ç –≤ INSERT
- –î–ª—è –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –∏–º–µ–Ω–Ω–æ INSERT –∫–æ–º–∞–Ω–¥—ã

## –°–ø–æ—Å–æ–± 1: Custom Format Backup (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –ª—é–±–æ–º —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ü—Ä—è–º–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
pg_restore -h localhost -U postgres -d your_database backup_custom_20251019_142216.dump

# –° –æ—á–∏—Å—Ç–∫–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
pg_restore -h localhost -U postgres -d your_database --clean backup_custom_20251019_142216.dump

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –Ω–µ–µ
createdb my_new_database
pg_restore -h localhost -U postgres -d my_new_database backup_custom_20251019_142216.dump

# –¢–æ–ª—å–∫–æ —Å—Ö–µ–º–∞ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
pg_restore -h localhost -U postgres -d your_database --schema-only backup_custom_20251019_142216.dump

# –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —Å—Ö–µ–º—ã
pg_restore -h localhost -U postgres -d your_database --data-only backup_custom_20251019_142216.dump

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
pg_restore -h localhost -U postgres -d your_database -t patients -t owners backup_custom_20251019_142216.dump

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ backup
pg_restore --list backup_custom_20251019_142216.dump | grep "TABLE DATA"
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Custom —Ñ–æ—Ä–º–∞—Ç–∞:
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –≤–µ—Ä—Å–∏—è—Ö PostgreSQL
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
‚úÖ –ú–æ–∂–Ω–æ –≤—ã–±–æ—Ä–æ—á–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚úÖ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏

## –°–ø–æ—Å–æ–± 2: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ INSERT —Ñ–æ—Ä–º–∞—Ç

–ï—Å–ª–∏ –≤–∞–º **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –Ω—É–∂–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π SQL —Å INSERT –∫–æ–º–∞–Ω–¥–∞–º–∏:

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:

```bash
# 1. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π backup
gunzip backup_20251019_115113.sql.gz

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é
./convert_to_inserts.sh backup_20251019_115113.sql backup_with_inserts.sql

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
psql -h localhost -U postgres -d your_database < backup_with_inserts.sql
```

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–π–º–µ—Ç 10-30 –º–∏–Ω—É—Ç
- –§–∞–π–ª —Å INSERT –±—É–¥–µ—Ç –≤ 3-5 —Ä–∞–∑ –±–æ–ª—å—à–µ
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- –ë–æ–ª—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ–∫

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π INSERT backup —á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î
createdb temp_restore

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—É–¥–∞ COPY backup
gunzip -c backup_20251019_115113.sql.gz | psql -d temp_restore

# 3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π backup —Å INSERT
pg_dump temp_restore --inserts --no-owner --no-privileges > backup_inserts.sql

# 4. –°–∂–∞—Ç—å –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
gzip backup_inserts.sql

# 5. –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î
dropdb temp_restore
```

## –°–ø–æ—Å–æ–± 3: –ß–∞—Å—Ç–∏—á–Ω—ã–π INSERT backup

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã INSERT —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Custom backup
pg_restore -d temp_db backup_custom_20251019_142216.dump

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å INSERT
pg_dump temp_db --inserts \
  -t patients \
  -t owners \
  -t appointments \
  -t medical_records \
  > important_tables_inserts.sql
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤

| –§–æ—Ä–º–∞—Ç | –†–∞–∑–º–µ—Ä | –°–∫–æ—Ä–æ—Å—Ç—å | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –ì–∏–±–∫–æ—Å—Ç—å |
|--------|--------|----------|---------------|----------|
| COPY (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π) | ‚≠ê‚≠ê‚≠ê –ú–∞–ª–µ–Ω—å–∫–∏–π | ‚≠ê‚≠ê‚≠ê –ë—ã—Å—Ç—Ä–æ | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | ‚≠ê –ù–∏–∑–∫–∞—è |
| Custom (.dump) | ‚≠ê‚≠ê‚≠ê –ú–∞–ª–µ–Ω—å–∫–∏–π | ‚≠ê‚≠ê‚≠ê –ë—ã—Å—Ç—Ä–æ | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è |
| INSERT (—Ç–µ–∫—Å—Ç) | ‚≠ê –ë–æ–ª—å—à–æ–π | ‚≠ê –ú–µ–¥–ª–µ–Ω–Ω–æ | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è |

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä

```bash
# –°–∫–∞—á–∞—Ç—å backup_custom_20251019_142216.dump –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp backup_custom_20251019_142216.dump user@server:/tmp/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh user@server
createdb vetsystem
pg_restore -d vetsystem /tmp/backup_custom_20251019_142216.dump
```

### –ü—Ä–∏–º–µ—Ä 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```bash
# –¢–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, constraints
pg_restore -d my_db --schema-only backup_custom_20251019_142216.dump
```

### –ü—Ä–∏–º–µ—Ä 3: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫

```bash
pg_restore -d my_db backup_custom_20251019_142216.dump --no-owner --no-privileges 2>&1 | tee restore.log
```

### –ü—Ä–∏–º–µ—Ä 4: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (–±—ã—Å—Ç—Ä–µ–µ)

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 4 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞
pg_restore -d my_db -j 4 backup_custom_20251019_142216.dump
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
psql -d your_database

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–±–ª–∏—Ü
SELECT count(*) FROM information_schema.tables 
WHERE table_schema = 'public';
-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 61

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
SELECT count(*) FROM patients;
SELECT count(*) FROM owners;
SELECT count(*) FROM appointments;

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
SELECT count(*) FROM information_schema.table_constraints 
WHERE table_schema = 'public';
```

## FAQ

**Q: –ü–æ—á–µ–º—É Custom —Ñ–æ—Ä–º–∞—Ç –ª—É—á—à–µ —á–µ–º INSERT?**
A: Custom —Ñ–æ—Ä–º–∞—Ç –±—ã—Å—Ç—Ä–µ–µ, –Ω–∞–¥–µ–∂–Ω–µ–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É.

**Q: –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –∏–º–µ–Ω–Ω–æ INSERT —Ñ–æ—Ä–º–∞—Ç?**
A: –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —á–∏—Ç–∞—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å SQL –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥—É—é –°–£–ë–î (MySQL –∏ —Ç.–ø.)

**Q: –ú–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Custom backup –Ω–∞ –¥—Ä—É–≥–æ–π –≤–µ—Ä—Å–∏–∏ PostgreSQL?**
A: –î–∞, Custom —Ñ–æ—Ä–º–∞—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ PostgreSQL.

**Q: –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É?**
A: `pg_restore -d db -t table_name backup.dump`

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Custom —Ñ–æ—Ä–º–∞—Ç** –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∑–∞–¥–∞—á
‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ COPY —Ñ–æ—Ä–º–∞—Ç** (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π) –µ—Å–ª–∏ custom –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç
‚ö†Ô∏è **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ INSERT —Ñ–æ—Ä–º–∞—Ç** —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

---

**–§–∞–π–ª—ã:**
- `backup_custom_20251019_142216.dump` - Custom —Ñ–æ—Ä–º–∞—Ç (30 –ú–ë) ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø
- `backup_20251019_115113.sql.gz` - COPY —Ñ–æ—Ä–º–∞—Ç (30 –ú–ë)
- `convert_to_inserts.sh` - –°–∫—Ä–∏–ø—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ INSERT
