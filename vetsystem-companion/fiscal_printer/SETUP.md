# üñ®Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—á–∞—Ç–∏ —Ñ–∏—Å–∫–∞–ª—å–Ω—ã—Ö —á–µ–∫–æ–≤

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

1. ‚úÖ Python –º–æ–¥—É–ª—å –¥–ª—è –ø–µ—á–∞—Ç–∏ (`fiscal_printer/printer.py`)
2. ‚úÖ IPC handlers –≤ Electron main process
3. ‚úÖ API –≤ preload –¥–ª—è renderer process
4. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (`PrinterSettingsPage.tsx`)

---

## üöÄ –û—Å—Ç–∞–≤—à–∏–µ—Å—è —à–∞–≥–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd vetsystem-companion/fiscal_printer
pip install -r requirements.txt
```

–ò–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ:
```bash
pip install pyserial
```

### 2. –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –≤ App.tsx

–î–æ–±–∞–≤—å—Ç–µ –≤ `vetsystem-companion/src/renderer/App.tsx`:

```tsx
import PrinterSettingsPage from './pages/PrinterSettingsPage';

// –í Switch/Router –¥–æ–±–∞–≤–∏—Ç—å:
<Route path="/printer-settings" component={PrinterSettingsPage} />
```

### 3. –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é

–í `SettingsPage.tsx` –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é:

```tsx
<Link href="/printer-settings">
  <Button variant="outline">
    <Printer className="mr-2 h-4 w-4" />
    –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞
  </Button>
</Link>
```

### 4. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –ø–µ—á–∞—Ç–∏ –≤ InvoicesPage.tsx

```tsx
import { Printer } from "lucide-react";

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
const handlePrintReceipt = async (invoice) => {
  const printerModel = await window.api.getSetting('printerModel');
  const printerPort = await window.api.getSetting('printerPort');
  
  if (!printerModel || !printerPort) {
    toast({
      title: "–û—à–∏–±–∫–∞",
      description: "–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∏–Ω—Ç–µ—Ä –≤ —Ä–∞–∑–¥–µ–ª–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
      variant: "destructive"
    });
    return;
  }

  const receiptData = {
    items: invoice.items.map(item => ({
      name: item.name,
      price: parseFloat(item.price),
      quantity: item.quantity
    })),
    payment_method: invoice.payment_status === 'paid' ? 'cash' : 'card',
    total: parseFloat(invoice.total_amount)
  };

  const result = await window.api.printReceipt(printerModel, printerPort, receiptData);
  
  if (result.success) {
    toast({
      title: "–£—Å–ø–µ—à–Ω–æ",
      description: "–ß–µ–∫ –Ω–∞–ø–µ—á–∞—Ç–∞–Ω"
    });
  } else {
    toast({
      title: "–û—à–∏–±–∫–∞",
      description: result.message,
      variant: "destructive"
    });
  }
};

// –í JSX:
<Button onClick={() => handlePrintReceipt(invoice)} size="sm" data-testid="button-print-receipt">
  <Printer className="h-4 w-4 mr-2" />
  –ü–µ—á–∞—Ç—å —á–µ–∫–∞
</Button>
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –¢–µ—Å—Ç –±–µ–∑ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞)

```bash
cd vetsystem-companion
npm run dev
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞"
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –∏ –ø–æ—Ä—Ç
3. –ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Ä—Ç–æ–≤

### 2. –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º

**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Vikiprint 57 –∏–ª–∏ ATOL 30F –∫ USB
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥—Ä–∞–π–≤–µ—Ä—ã (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
3. –û—Ç–∫—Ä–æ–π—Ç–µ –î–∏—Å–ø–µ—Ç—á–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤ ‚Üí –Ω–∞–π–¥–∏—Ç–µ COM-–ø–æ—Ä—Ç

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
1. –í Companion ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞
2. –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –∏ –ø–æ—Ä—Ç
3. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"
4. –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
5. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å—á–µ—Ç
6. –ù–∞–∂–º–∏—Ç–µ "–ü–µ—á–∞—Ç—å —á–µ–∫–∞"

### 3. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É

```bash
# –¢–µ—Å—Ç Vikiprint
python fiscal_printer/printer.py vikiprint COM3 '{"items":[{"name":"–¢–µ—Å—Ç","price":100,"quantity":1}],"payment_method":"cash","total":100}'

# –¢–µ—Å—Ç ATOL
python fiscal_printer/printer.py atol COM3 '{"items":[{"name":"–¢–µ—Å—Ç","price":100,"quantity":1}],"payment_method":"cash","total":100}'
```

---

## üîß –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "python –Ω–µ –Ω–∞–π–¥–µ–Ω"

**Windows:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É Python
python --version

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ py
py --version
```

–ï—Å–ª–∏ Python –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
1. –°–∫–∞—á–∞–π—Ç–µ —Å https://www.python.org/downloads/
2. –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –≤–∫–ª—é—á–∏—Ç–µ "Add Python to PATH"

### –ü—Ä–æ–±–ª–µ–º–∞: "–ú–æ–¥—É–ª—å serial –Ω–µ –Ω–∞–π–¥–µ–Ω"

```bash
pip install pyserial
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

1. –ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ—Ä—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥—Ä–∞–π–≤–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π COM-–ø–æ—Ä—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–µ—á–∞—Ç–∞–µ—Ç—Å—è –º—É—Å–æ—Ä"

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å CP866)
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–∏–∑–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ –¥–æ 9600 baud

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### –§–∏—Å–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** - –±–∞–∑–æ–≤–∞—è –ø–µ—á–∞—Ç—å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.

–î–ª—è **–ø–æ–ª–Ω–æ–π —Ñ–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏–∏** —Ç—Ä–µ–±—É–µ—Ç—Å—è:
- –§–∏—Å–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤ –ø—Ä–∏–Ω—Ç–µ—Ä–µ
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –Ω–∞–ª–æ–≥–æ–≤–æ–π
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –û–§–î
- –ü–æ–ª–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é Dreamkas (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ VetSystem)
- –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ–ª–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã ATOL/VikiDriver –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö COM API

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [ ] Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] pyserial —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ü—Ä–∏–Ω—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω
- [ ] COM-–ø–æ—Ä—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
- [ ] –ú–∞—Ä—à—Ä—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ App.tsx
- [ ] –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ InvoicesPage
- [ ] –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å–ø–µ—à–µ–Ω
- [ ] –¢–µ—Å—Ç –ø–µ—á–∞—Ç–∏ —É—Å–ø–µ—à–µ–Ω

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ Companion
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Python —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ—Ä—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä–∞–π–≤–µ—Ä—ã –ø—Ä–∏–Ω—Ç–µ—Ä–∞
