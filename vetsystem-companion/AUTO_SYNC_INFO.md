# üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1Ô∏è‚É£ –°–µ—Ä–≤–µ—Ä ‚Üí Companion (–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
–ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:
- ‚úÖ **61,974 –∫–ª–∏–µ–Ω—Ç–∞**
- ‚úÖ **82,371 –ø–∞—Ü–∏–µ–Ω—Ç–∞** 
- ‚úÖ **1,092 –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã** (—É—Å–ª—É–≥–∏ + —Ç–æ–≤–∞—Ä—ã)

### 2Ô∏è‚É£ Companion ‚Üí –°–µ—Ä–≤–µ—Ä (–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ **–æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ **–æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**:

| –î–µ–π—Å—Ç–≤–∏–µ | –õ–æ–∫–∞–ª—å–Ω–æ | –û—á–µ—Ä–µ–¥—å | –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä |
|----------|----------|---------|-------------------|
| –°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ | ‚úÖ SQLite | ‚úÖ sync_queue | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –°–æ–∑–¥–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ | ‚úÖ SQLite | ‚úÖ sync_queue | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å | ‚úÖ SQLite | ‚úÖ sync_queue | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| **–°–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç** | ‚úÖ SQLite | ‚úÖ sync_queue | ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** |

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: **60 —Å–µ–∫—É–Ω–¥ (1 –º–∏–Ω—É—Ç–∞)**

–ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É Companion:
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
2. ‚úÖ –ï—Å–ª–∏ –æ–Ω–ª–∞–π–Ω - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ pending –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç server_id –¥–ª—è —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
4. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ UI

### –ö–æ–¥ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
```typescript
// vetsystem-companion/src/main/index.ts (—Å—Ç—Ä–æ–∫–∞ 428)
syncService.startAutoSync(60000); // 60000 –º—Å = 1 –º–∏–Ω—É—Ç–∞
```

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞
```
1. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –æ—Ç–∫–ª—é—á–∏–ª—Å—è
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
   ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ (id=12345, server_id=null)
   ‚Üí –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ sync_queue (action_type='create_client', status='pending')
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç —Å—á–µ—Ç –Ω–∞ 5000‚ÇΩ
   ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ (id=67890, server_id=null)
   ‚Üí –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ sync_queue (action_type='create_invoice', status='pending')
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```
4. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ—è–≤–∏–ª—Å—è —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç
5. –ß–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É Companion –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   ‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (isOnline=true)
   ‚úì –ù–∞—Ö–æ–¥–∏—Ç 2 pending –∑–∞–ø–∏—Å–∏ –≤ sync_queue
   ‚úì –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST /api/sync/upload-changes —Å –º–∞—Å—Å–∏–≤–æ–º –¥–µ–π—Å—Ç–≤–∏–π
   ‚úì –°–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç UUID: "abc-123...")
   ‚úì –°–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞–µ—Ç —Å—á–µ—Ç (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç UUID: "xyz-789...")
   ‚úì Companion –æ–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏:
      - –ö–ª–∏–µ–Ω—Ç: server_id="abc-123...", synced=1
      - –°—á–µ—Ç: server_id="xyz-789...", synced=1
   ‚úì –£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ sync_queue (status='success')
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Companion

**–°—Ç—Ä–æ–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è** (SyncStatusBar):
- üü¢ **"–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã"** - –Ω–µ—Ç pending –∏–∑–º–µ–Ω–µ–Ω–∏–π
- üü° **"–û–∂–∏–¥–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: 3"** - –µ—Å—Ç—å 3 –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è
- üîµ **"–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è..."** - –∏–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- üî¥ **"–û—Ñ–ª–∞–π–Ω"** - –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

**–ö–Ω–æ–ø–∫–∞ "‚Üª –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å"**:
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
- –ü–æ–ª–µ–∑–Ω–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å 1 –º–∏–Ω—É—Ç—ã

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –¢–∞–±–ª–∏—Ü–∞ sync_queue (SQLite)
```sql
CREATE TABLE sync_queue (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  action_type TEXT NOT NULL,           -- 'create_client', 'create_invoice', etc.
  payload TEXT NOT NULL,                -- JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è
  status TEXT DEFAULT 'pending',        -- 'pending', 'success', 'error'
  error_message TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### API Endpoints

**POST /api/sync/upload-changes**
```json
Request:
{
  "actions": [
    {
      "queue_id": 1,
      "action_type": "create_invoice",
      "payload": {
        "local_id": 67890,
        "patient_server_id": "patient-uuid-123",
        "total_amount": 5000,
        "payment_status": "pending",
        "items": [
          { "type": "service", "nomenclature_id": 10, "name": "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", "quantity": 1, "price": 2000, "total": 2000 },
          { "type": "product", "nomenclature_id": 25, "name": "–í–∏—Ç–∞–º–∏–Ω—ã", "quantity": 1, "price": 3000, "total": 3000 }
        ]
      }
    }
  ]
}

Response:
{
  "results": [
    {
      "queue_id": 1,
      "status": "success",
      "server_id": "invoice-uuid-xyz-789",
      "local_id": 67890
    }
  ]
}
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ó–∞–ø—É—Å–∫ –Ω–∞ Windows
```bash
cd C:\VetSystem\vetsystem-companion
npm run dev
```

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
```
[STARTUP] ‚úì Sync service initialized
[STARTUP] ‚úì Auto-sync started (interval: 60s)
[STARTUP] ‚úì All services ready
Auto-sync started (interval: 60000ms)

# –ß–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥:
Checking connection to server...
Connection successful
Uploading 3 pending changes...
‚úì Sync completed: 3 actions uploaded
```

---

## üéâ –ò—Ç–æ–≥

–¢–µ–ø–µ—Ä—å VetSystem Companion –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é**:
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤ –æ—Ñ–ª–∞–π–Ω —Å –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ù–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!** üöÄ
